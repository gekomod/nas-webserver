import{_ as q,r as A,o as J,b as n,d as E,e as i,g as e,w as t,f as d,h as f,k as m,I as v,F as c,l as R,t as C,i as L,m as O,y as P,z as I,a2 as B}from"./index-JqcLm-KS.js";const Q={class:"system-settings"},h={class:"card-header"},ee={key:0,class:"loading-spinner"},le={class:"service-checkbox"},ae={key:0,class:"loading-spinner"},oe={class:"action-buttons"},te={__name:"Settings",setup(se){const M=A("docker"),a=A({docker:{composeDir:"/opt/docker/compose",dataRoot:"/var/lib/docker",autoStart:!0},system:{hostname:"",timezone:"Europe/Warsaw",language:"pl"},ui:{theme:"system",sidebarMode:"vertical"},services:{monitoredServices:[]},updates:{autoUpdate:!1,schedule:"0 0 * * *",updateCommand:"sudo apt-get update && sudo apt-get upgrade -y"},webserver:{PORT:80,FRONTEND_PATH:"/opt/nas-panel/dist",API_PREFIX:"/api",ENABLE_HTTPS:!1,SSL_CERT_PATH:"",SSL_KEY_PATH:"",CACHE_ENABLED:!0,CACHE_MAX_SIZE:100,CACHE_TTL:3600,GZIP_ENABLED:!0,GZIP_MIN_SIZE:1024,CORS_ENABLED:!0,HSTS_ENABLED:!0,HSTS_MAX_AGE:31536e3,LOG_LEVEL:"info",LOG_FILE:"/var/log/nas-web.log",LOG_MAX_SIZE:10,LOG_BACKUP_COUNT:5,MAX_THREADS:10,MAX_CONNECTIONS:100,CONNECTION_TIMEOUT:30,HTTP2_ENABLED:!1,HTTP2_CERT_PATH:"",HTTP2_KEY_PATH:"",HTTP2_MAX_STREAMS:100,HTTP2_WINDOW_SIZE:65536}}),$=A([{value:"nas-web",label:"Web Server",icon:"mdi:server"},{value:"nas-webdav",label:"Dav Server",icon:"mdi:folder-network"},{value:"docker",label:"Docker",icon:"mdi:docker"},{value:"ssh",label:"SSH",icon:"mdi:lock"},{value:"cron",label:"Cron",icon:"mdi:clock"},{value:"smbd",label:"Samba",icon:"mdi:folder-network"},{value:"nginx",label:"NGINX",icon:"mdi:nginx"},{value:"mysql",label:"MySQL",icon:"mdi:database"},{value:"postgresql",label:"PostgreSQL",icon:"mdi:database"}]),H=A(!0),N=A(!1),z=A(["Europe/Warsaw","Europe/London","America/New_York","Asia/Tokyo"]),D=async()=>{try{H.value=!0;const[s,l]=await Promise.all([P.get("/system/settings"),P.get("/system/webserver-config")]);a.value={...a.value,...s.data,webserver:{...a.value.webserver,...l.data}},a.value.services?.monitoredServices?a.value.services.monitoredServices=Array.isArray(a.value.services.monitoredServices)?a.value.services.monitoredServices:[]:a.value.services.monitoredServices=[]}catch(s){I.error("Failed to load settings"),console.error(s),a.value.services.monitoredServices=[]}finally{H.value=!1}},X=async()=>{try{N.value=!0,await P.post("/system/settings",{...a.value,webserver:void 0}),await P.post("/system/save-webserver-config",a.value.webserver),I.success("Ustawienia zapisane"),B.global.locale.value!==a.value.system.language&&window.location.reload()}catch(s){I.error("Błąd zapisywania ustawień"),console.error(s)}finally{N.value=!1}},W=async()=>{try{const l=(await P.get("/system/cron-jobs")).data.find(y=>y.id==="system-auto-updates");l&&(a.value.updates={autoUpdate:!0,schedule:l.schedule,updateCommand:l.command})}catch(s){console.error("Error checking system cron jobs:",s)}},F=()=>{D()},G=s=>{B.global.locale.value=s},g=s=>{console.log("Browsing directory for field:",s)};return J(()=>{D(),W()}),(s,l)=>{const y=n("el-icon"),b=n("el-button"),p=n("el-input"),u=n("el-form-item"),T=n("el-switch"),w=n("el-form"),k=n("el-tab-pane"),r=n("el-option"),S=n("el-select"),V=n("el-divider"),K=n("el-checkbox"),Z=n("el-checkbox-group"),_=n("el-input-number"),U=n("el-tooltip"),Y=n("el-alert"),x=n("el-tabs"),j=n("el-card");return i(),E("div",Q,[e(j,{shadow:"hover",class:"settings-card"},{header:t(()=>[d("div",h,[e(y,{size:"24"},{default:t(()=>[e(m(v),{icon:"mdi:cog"})]),_:1}),d("span",null,C(s.$t("settings.systemSettings")),1)])]),default:t(()=>[e(x,{modelValue:M.value,"onUpdate:modelValue":l[42]||(l[42]=o=>M.value=o),type:"card"},{default:t(()=>[e(k,{label:"Docker",name:"docker"},{default:t(()=>[H.value?(i(),E("div",ee,[e(y,{size:32,class:"is-loading"},{default:t(()=>[e(m(v),{icon:"mdi:loading"})]),_:1})])):(i(),f(w,{key:1,ref:"dockerForm",model:a.value.docker,"label-position":"top"},{default:t(()=>[e(u,{label:s.$t("settings.dockerComposeDir")},{default:t(()=>[e(p,{modelValue:a.value.docker.composeDir,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.docker.composeDir=o),placeholder:s.$t("settings.dockerComposeDirPlaceholder")},{append:t(()=>[e(b,{onClick:l[0]||(l[0]=o=>g("docker.composeDir"))},{default:t(()=>[e(m(v),{icon:"mdi:folder-search"})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(u,{label:s.$t("settings.dockerDataRoot")},{default:t(()=>[e(p,{modelValue:a.value.docker.dataRoot,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.docker.dataRoot=o),placeholder:s.$t("settings.dockerDataRootPlaceholder")},{append:t(()=>[e(b,{onClick:l[2]||(l[2]=o=>g("docker.dataRoot"))},{default:t(()=>[e(m(v),{icon:"mdi:folder-search"})]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),e(u,{label:s.$t("settings.dockerAutoStart")},{default:t(()=>[e(T,{modelValue:a.value.docker.autoStart,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.docker.autoStart=o)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]))]),_:1}),e(k,{label:"System",name:"system"},{default:t(()=>[e(w,{ref:"systemForm",model:a.value.system,"label-position":"top"},{default:t(()=>[e(u,{label:s.$t("settings.hostname")},{default:t(()=>[e(p,{modelValue:a.value.system.hostname,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.system.hostname=o)},null,8,["modelValue"])]),_:1},8,["label"]),e(u,{label:s.$t("settings.timezone")},{default:t(()=>[e(S,{modelValue:a.value.system.timezone,"onUpdate:modelValue":l[6]||(l[6]=o=>a.value.system.timezone=o),filterable:""},{default:t(()=>[(i(!0),E(c,null,R(z.value,o=>(i(),f(r,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(u,{label:s.$t("settings.language")},{default:t(()=>[e(S,{modelValue:a.value.system.language,"onUpdate:modelValue":l[7]||(l[7]=o=>a.value.system.language=o),onChange:G},{default:t(()=>[e(r,{label:"Polski",value:"pl"}),e(r,{label:"English",value:"en"})]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"]),e(V),d("h3",null,C(s.$t("settings.autoUpdatesTitle")),1),e(w,{model:a.value.updates,"label-position":"top"},{default:t(()=>[e(u,{label:s.$t("settings.enableAutoUpdates")},{default:t(()=>[e(T,{modelValue:a.value.updates.autoUpdate,"onUpdate:modelValue":l[8]||(l[8]=o=>a.value.updates.autoUpdate=o)},null,8,["modelValue"])]),_:1},8,["label"]),a.value.updates.autoUpdate?(i(),f(u,{key:0,label:s.$t("settings.updateSchedule")},{default:t(()=>[e(S,{modelValue:a.value.updates.schedule,"onUpdate:modelValue":l[9]||(l[9]=o=>a.value.updates.schedule=o)},{default:t(()=>[e(r,{value:"0 0 * * *",label:s.$t("settings.dailyMidnight")},null,8,["label"]),e(r,{value:"0 0 * * 0",label:s.$t("settings.weeklySunday")},null,8,["label"]),e(r,{value:"0 0 1 * *",label:s.$t("settings.monthlyFirstDay")},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])):L("",!0),a.value.updates.autoUpdate?(i(),f(u,{key:1,label:s.$t("settings.updateCommand")},{default:t(()=>[e(p,{modelValue:a.value.updates.updateCommand,"onUpdate:modelValue":l[10]||(l[10]=o=>a.value.updates.updateCommand=o)},null,8,["modelValue"])]),_:1},8,["label"])):L("",!0)]),_:1},8,["model"])]),_:1}),e(k,{label:"Interfejs",name:"ui"},{default:t(()=>[e(w,{ref:"uiForm",model:a.value.ui,"label-position":"top"},{default:t(()=>[e(u,{label:s.$t("settings.theme")},{default:t(()=>[e(S,{modelValue:a.value.ui.theme,"onUpdate:modelValue":l[11]||(l[11]=o=>a.value.ui.theme=o)},{default:t(()=>[e(r,{label:"Light",value:"light"}),e(r,{label:"Dark",value:"dark"}),e(r,{label:"System",value:"system"})]),_:1},8,["modelValue"])]),_:1},8,["label"]),e(u,{label:s.$t("settings.sidebarMode")},{default:t(()=>[e(S,{modelValue:a.value.ui.sidebarMode,"onUpdate:modelValue":l[12]||(l[12]=o=>a.value.ui.sidebarMode=o)},{default:t(()=>[e(r,{label:s.$t("settings.sidebarVertical"),value:"vertical"},null,8,["label"]),e(r,{label:s.$t("settings.sidebarHorizontal"),value:"horizontal"},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1}),e(k,{label:"Usługi",name:"services"},{default:t(()=>[e(w,{ref:"servicesForm",model:a.value.services,"label-position":"top"},{default:t(()=>[e(Z,{modelValue:a.value.services.monitoredServices,"onUpdate:modelValue":l[13]||(l[13]=o=>a.value.services.monitoredServices=o)},{default:t(()=>[(i(!0),E(c,null,R($.value,o=>(i(),f(K,{key:o.value,value:o.value},{default:t(()=>[d("div",le,[e(m(v),{icon:o.icon,width:"18"},null,8,["icon"]),d("span",null,C(o.label),1)])]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1}),e(k,{label:"Serwer WWW",name:"webserver"},{default:t(()=>[H.value?(i(),E("div",ae,[e(y,{size:32,class:"is-loading"},{default:t(()=>[e(m(v),{icon:"mdi:loading"})]),_:1})])):(i(),f(w,{key:1,ref:"webserverForm",model:a.value.webserver,"label-position":"top"},{default:t(()=>[l[47]||(l[47]=d("h3",null,"Podstawowe ustawienia",-1)),e(u,{label:"Port serwera"},{default:t(()=>[e(_,{modelValue:a.value.webserver.PORT,"onUpdate:modelValue":l[14]||(l[14]=o=>a.value.webserver.PORT=o),min:1,max:65535},null,8,["modelValue"])]),_:1}),e(u,{label:"Ścieżka do frontendu"},{default:t(()=>[e(p,{modelValue:a.value.webserver.FRONTEND_PATH,"onUpdate:modelValue":l[15]||(l[15]=o=>a.value.webserver.FRONTEND_PATH=o),readonly:!0,disabled:!0},{append:t(()=>[e(U,{content:"Ta ścieżka jest ustalana podczas instalacji",placement:"top"},{default:t(()=>[e(b,{disabled:!0},{default:t(()=>[e(m(v),{icon:"mdi:folder-search"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"Prefiks API"},{default:t(()=>[e(p,{modelValue:a.value.webserver.API_PREFIX,"onUpdate:modelValue":l[16]||(l[16]=o=>a.value.webserver.API_PREFIX=o),readonly:!0,disabled:!0,class:"readonly-input"},{append:t(()=>[e(U,{content:"Wartość konfigurowana podczas wdrożenia",placement:"top"},{default:t(()=>[e(b,{disabled:!0},{default:t(()=>[e(m(v),{icon:"mdi:api-off"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(V),l[48]||(l[48]=d("h3",null,"Performance Settings",-1)),e(u,{label:"Max Worker Threads"},{default:t(()=>[e(_,{modelValue:a.value.webserver.MAX_THREADS,"onUpdate:modelValue":l[17]||(l[17]=o=>a.value.webserver.MAX_THREADS=o),min:1,max:64,step:1},null,8,["modelValue"]),l[43]||(l[43]=d("span",{class:"input-description"},"Number of worker threads for request processing",-1))]),_:1,__:[43]}),e(u,{label:"Max Connections"},{default:t(()=>[e(_,{modelValue:a.value.webserver.MAX_CONNECTIONS,"onUpdate:modelValue":l[18]||(l[18]=o=>a.value.webserver.MAX_CONNECTIONS=o),min:10,max:1e4,step:10},null,8,["modelValue"]),l[44]||(l[44]=d("span",{class:"input-description"},"Maximum simultaneous connections",-1))]),_:1,__:[44]}),e(u,{label:"Connection Timeout (seconds)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.CONNECTION_TIMEOUT,"onUpdate:modelValue":l[19]||(l[19]=o=>a.value.webserver.CONNECTION_TIMEOUT=o),min:1,max:300},null,8,["modelValue"]),l[45]||(l[45]=d("span",{class:"input-description"},"Timeout for idle connections",-1))]),_:1,__:[45]}),e(V),l[49]||(l[49]=d("h3",null,"HTTPS",-1)),e(u,{label:"Włącz HTTPS"},{default:t(()=>[e(T,{modelValue:a.value.webserver.ENABLE_HTTPS,"onUpdate:modelValue":l[20]||(l[20]=o=>a.value.webserver.ENABLE_HTTPS=o)},null,8,["modelValue"])]),_:1}),a.value.webserver.ENABLE_HTTPS?(i(),E(c,{key:0},[e(u,{label:"Ścieżka do certyfikatu SSL"},{default:t(()=>[e(p,{modelValue:a.value.webserver.SSL_CERT_PATH,"onUpdate:modelValue":l[22]||(l[22]=o=>a.value.webserver.SSL_CERT_PATH=o)},{append:t(()=>[e(b,{onClick:l[21]||(l[21]=o=>g("webserver.SSL_CERT_PATH"))},{default:t(()=>[e(m(v),{icon:"mdi:file-search"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"Ścieżka do klucza SSL"},{default:t(()=>[e(p,{modelValue:a.value.webserver.SSL_KEY_PATH,"onUpdate:modelValue":l[24]||(l[24]=o=>a.value.webserver.SSL_KEY_PATH=o)},{append:t(()=>[e(b,{onClick:l[23]||(l[23]=o=>g("webserver.SSL_KEY_PATH"))},{default:t(()=>[e(m(v),{icon:"mdi:file-search"})]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)):L("",!0),e(V),l[50]||(l[50]=d("h3",null,"HTTP/2 Configuration",-1)),e(u,{label:"Enable HTTP/2"},{default:t(()=>[e(T,{modelValue:a.value.webserver.HTTP2_ENABLED,"onUpdate:modelValue":l[25]||(l[25]=o=>a.value.webserver.HTTP2_ENABLED=o)},null,8,["modelValue"])]),_:1}),a.value.webserver.HTTP2_ENABLED?(i(),E(c,{key:1},[e(u,{label:"HTTP/2 Certificate Path"},{default:t(()=>[e(p,{modelValue:a.value.webserver.HTTP2_CERT_PATH,"onUpdate:modelValue":l[27]||(l[27]=o=>a.value.webserver.HTTP2_CERT_PATH=o)},{append:t(()=>[e(b,{onClick:l[26]||(l[26]=o=>g("HTTP2_CERT_PATH"))},{default:t(()=>[e(m(v),{icon:"mdi:file-certificate-outline"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"HTTP/2 Key Path"},{default:t(()=>[e(p,{modelValue:a.value.webserver.HTTP2_KEY_PATH,"onUpdate:modelValue":l[29]||(l[29]=o=>a.value.webserver.HTTP2_KEY_PATH=o)},{append:t(()=>[e(b,{onClick:l[28]||(l[28]=o=>g("HTTP2_KEY_PATH"))},{default:t(()=>[e(m(v),{icon:"mdi:key-outline"})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"Max Concurrent Streams"},{default:t(()=>[e(_,{modelValue:a.value.webserver.HTTP2_MAX_STREAMS,"onUpdate:modelValue":l[30]||(l[30]=o=>a.value.webserver.HTTP2_MAX_STREAMS=o),min:1,max:1e3},null,8,["modelValue"])]),_:1}),e(u,{label:"Initial Window Size (bytes)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.HTTP2_WINDOW_SIZE,"onUpdate:modelValue":l[31]||(l[31]=o=>a.value.webserver.HTTP2_WINDOW_SIZE=o),min:65535,max:2147483647,step:1024},null,8,["modelValue"])]),_:1})],64)):(i(),f(Y,{key:2,type:"info",closable:!1},{default:t(()=>l[46]||(l[46]=[O(" HTTP/2 is currently disabled. Enable to configure advanced settings. ")])),_:1,__:[46]})),e(V),l[51]||(l[51]=d("h3",null,"Cache",-1)),e(u,{label:"Włącz cache"},{default:t(()=>[e(T,{modelValue:a.value.webserver.CACHE_ENABLED,"onUpdate:modelValue":l[32]||(l[32]=o=>a.value.webserver.CACHE_ENABLED=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"Maksymalny rozmiar cache (MB)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.CACHE_MAX_SIZE,"onUpdate:modelValue":l[33]||(l[33]=o=>a.value.webserver.CACHE_MAX_SIZE=o),min:1,max:1e3,"controls-position":"right"},null,8,["modelValue"])]),_:1}),e(u,{label:"TTL cache (sekundy)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.CACHE_TTL,"onUpdate:modelValue":l[34]||(l[34]=o=>a.value.webserver.CACHE_TTL=o),min:60,max:86400,"controls-position":"right"},null,8,["modelValue"])]),_:1}),e(V),l[52]||(l[52]=d("h3",null,"Bezpieczeństwo",-1)),e(u,{label:"Włącz CORS"},{default:t(()=>[e(T,{modelValue:a.value.webserver.CORS_ENABLED,"onUpdate:modelValue":l[35]||(l[35]=o=>a.value.webserver.CORS_ENABLED=o)},null,8,["modelValue"])]),_:1}),e(u,{label:"Włącz HSTS"},{default:t(()=>[e(T,{modelValue:a.value.webserver.HSTS_ENABLED,"onUpdate:modelValue":l[36]||(l[36]=o=>a.value.webserver.HSTS_ENABLED=o)},null,8,["modelValue"])]),_:1}),a.value.webserver.HSTS_ENABLED?(i(),f(u,{key:3,label:"Maksymalny wiek HSTS (sekundy)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.HSTS_MAX_AGE,"onUpdate:modelValue":l[37]||(l[37]=o=>a.value.webserver.HSTS_MAX_AGE=o),min:0,max:63072e3},null,8,["modelValue"])]),_:1})):L("",!0),e(V),l[53]||(l[53]=d("h3",null,"Logowanie",-1)),e(u,{label:"Poziom logowania"},{default:t(()=>[e(S,{modelValue:a.value.webserver.LOG_LEVEL,"onUpdate:modelValue":l[38]||(l[38]=o=>a.value.webserver.LOG_LEVEL=o)},{default:t(()=>[e(r,{label:"Debug",value:"debug"}),e(r,{label:"Info",value:"info"}),e(r,{label:"Warning",value:"warning"}),e(r,{label:"Error",value:"error"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"Plik logów"},{default:t(()=>[e(p,{modelValue:a.value.webserver.LOG_FILE,"onUpdate:modelValue":l[39]||(l[39]=o=>a.value.webserver.LOG_FILE=o),readonly:!0,disabled:!0,class:"readonly-input"},{append:t(()=>[e(U,{content:"Wartość konfigurowana automatycznie",placement:"top"},{default:t(()=>[e(b,{disabled:!0},{default:t(()=>[e(m(v),{icon:"mdi:api-off"})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"Maksymalny rozmiar logu (MB)"},{default:t(()=>[e(_,{modelValue:a.value.webserver.LOG_MAX_SIZE,"onUpdate:modelValue":l[40]||(l[40]=o=>a.value.webserver.LOG_MAX_SIZE=o),min:1,max:100},null,8,["modelValue"])]),_:1}),e(u,{label:"Liczba archiwalnych logów"},{default:t(()=>[e(_,{modelValue:a.value.webserver.LOG_BACKUP_COUNT,"onUpdate:modelValue":l[41]||(l[41]=o=>a.value.webserver.LOG_BACKUP_COUNT=o),min:1,max:20},null,8,["modelValue"])]),_:1})]),_:1,__:[47,48,49,50,51,52,53]},8,["model"]))]),_:1})]),_:1},8,["modelValue"]),d("div",oe,[e(b,{type:"primary",onClick:X,loading:N.value},{default:t(()=>[O(C(s.$t("settings.save")),1)]),_:1},8,["loading"]),e(b,{onClick:F},{default:t(()=>[O(C(s.$t("settings.reset")),1)]),_:1})])]),_:1})])}}},ne=q(te,[["__scopeId","data-v-2e616f31"]]);export{ne as default};
