import{_ as j,r as m,c as G,o as H,b as r,v as J,d as K,e as V,f as d,x as O,g as o,m as n,w as t,k as f,I as _,t as a,h as R,y as z,z as y,B as W}from"./index-JqcLm-KS.js";const X={class:"process-monitor"},Y={class:"monitor-header"},Z={class:"controls"},x={class:"percentage"},ee={class:"percentage"},oe={class:"command"},te={__name:"ProcessMonitor",setup(le){const b=m(!1),M=m([]),g=m(""),v=m(!1),i=m({}),B=G(()=>{if(!g.value)return M.value;const e=g.value.toLowerCase();return M.value.filter(l=>l.name.toLowerCase().includes(e)||l.pid.toString().includes(e)||l.user.toLowerCase().includes(e)||l.command.toLowerCase().includes(e))}),P=e=>e>70?"#f56c6c":e>30?"#e6a23c":"#67c23a",T=e=>e>80?"#f56c6c":e>50?"#e6a23c":"#67c23a",w=e=>{switch(e.toLowerCase()){case"running":return"success";case"sleeping":return"primary";case"stopped":return"warning";case"zombie":return"danger";default:return"info"}},$=async()=>{try{b.value=!0;const e=await z.get("/diagnostics/processes");M.value=e.data.processes.map(l=>({...l,cpu:parseFloat(l.cpu),memory:parseFloat(l.memory),protected:l.user==="root"||l.pid<100}))}catch(e){y.error($t("processMonitor.messages.loadError")),console.error(e)}finally{b.value=!1}},E=()=>{$()},L=e=>{W.confirm($t("processMonitor.confirmations.killMessage",{pid:e}),$t("processMonitor.confirmations.killTitle"),{confirmButtonText:$t("processMonitor.confirmations.confirmText"),cancelButtonText:$t("processMonitor.confirmations.cancelText"),type:"warning"}).then(async()=>{try{await z.post("/diagnostics/processes/kill",{pid:e}),y.success($t("processMonitor.messages.killSuccess",{pid:e})),$()}catch(l){y.error($t("processMonitor.messages.killError",{error:l.response?.data?.message||l.message}))}}).catch(()=>{})},F=e=>{i.value=e,v.value=!0};return H(()=>{$()}),(e,l)=>{const p=r("el-icon"),h=r("el-button"),S=r("el-input"),u=r("el-table-column"),k=r("el-progress"),D=r("el-tag"),C=r("el-tooltip"),I=r("el-button-group"),N=r("el-table"),c=r("el-descriptions-item"),A=r("el-descriptions"),U=r("el-dialog"),q=J("loading");return V(),K("div",X,[d("div",Y,[d("h2",null,[o(p,null,{default:t(()=>[o(f(_),{icon:"mdi:chart-box"})]),_:1}),n(" "+a(e.$t("processMonitor.title")),1)]),d("div",Z,[o(h,{size:"small",onClick:E,loading:b.value},{default:t(()=>[o(p,null,{default:t(()=>[o(f(_),{icon:"mdi:refresh"})]),_:1}),n(" "+a(e.$t("processMonitor.refresh")),1)]),_:1},8,["loading"]),o(S,{modelValue:g.value,"onUpdate:modelValue":l[0]||(l[0]=s=>g.value=s),placeholder:e.$t("processMonitor.searchPlaceholder"),clearable:"",style:{width:"200px"},size:"small"},{prefix:t(()=>[o(p,null,{default:t(()=>[o(f(_),{icon:"mdi:magnify"})]),_:1})]),_:1},8,["modelValue","placeholder"])])]),O((V(),R(N,{data:B.value,style:{width:"100%"},stripe:"",border:"",height:"calc(100vh - 220px)"},{default:t(()=>[o(u,{prop:"pid",label:e.$t("processMonitor.columns.pid"),width:"80",sortable:""},null,8,["label"]),o(u,{prop:"name",label:e.$t("processMonitor.columns.name"),width:"180",sortable:""},null,8,["label"]),o(u,{prop:"user",label:e.$t("processMonitor.columns.user"),width:"120",sortable:""},null,8,["label"]),o(u,{prop:"cpu",label:e.$t("processMonitor.columns.cpu"),width:"100",sortable:""},{default:t(({row:s})=>[o(k,{percentage:s.cpu,color:P(s.cpu),"show-text":!1,"stroke-width":16},null,8,["percentage","color"]),d("span",x,a(s.cpu.toFixed(1))+"%",1)]),_:1},8,["label"]),o(u,{prop:"memory",label:e.$t("processMonitor.columns.memory"),width:"120",sortable:""},{default:t(({row:s})=>[o(k,{percentage:s.memory,color:T(s.memory),"show-text":!1,"stroke-width":16},null,8,["percentage","color"]),d("span",ee,a(s.memory.toFixed(1))+"%",1)]),_:1},8,["label"]),o(u,{prop:"status",label:e.$t("processMonitor.columns.status"),width:"100",sortable:""},{default:t(({row:s})=>[o(D,{type:w(s.status),size:"small"},{default:t(()=>[n(a(s.status),1)]),_:2},1032,["type"])]),_:1},8,["label"]),o(u,{prop:"command",label:e.$t("processMonitor.columns.command"),"show-overflow-tooltip":""},null,8,["label"]),o(u,{label:e.$t("processMonitor.columns.actions"),width:"120"},{default:t(({row:s})=>[o(I,null,{default:t(()=>[o(C,{content:e.$t("processMonitor.tooltips.kill"),placement:"top"},{default:t(()=>[o(h,{size:"small",type:"danger",onClick:Q=>L(s.pid),disabled:s.protected},{default:t(()=>[o(p,null,{default:t(()=>[o(f(_),{icon:"mdi:skull"})]),_:1})]),_:2},1032,["onClick","disabled"])]),_:2},1032,["content"]),o(C,{content:e.$t("processMonitor.tooltips.details"),placement:"top"},{default:t(()=>[o(h,{size:"small",type:"info",onClick:Q=>F(s)},{default:t(()=>[o(p,null,{default:t(()=>[o(f(_),{icon:"mdi:information"})]),_:1})]),_:2},1032,["onClick"])]),_:2},1032,["content"])]),_:2},1024)]),_:1},8,["label"])]),_:1},8,["data"])),[[q,b.value]]),o(U,{modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=s=>v.value=s),title:e.$t("processMonitor.detailsDialog.title"),width:"60%"},{footer:t(()=>[o(h,{onClick:l[1]||(l[1]=s=>v.value=!1)},{default:t(()=>[n(a(e.$t("processMonitor.detailsDialog.close")),1)]),_:1})]),default:t(()=>[o(A,{column:2,border:""},{default:t(()=>[o(c,{label:e.$t("processMonitor.detailsDialog.pid")},{default:t(()=>[n(a(i.value.pid),1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.name")},{default:t(()=>[n(a(i.value.name),1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.user")},{default:t(()=>[n(a(i.value.user),1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.status")},{default:t(()=>[o(D,{type:w(i.value.status),size:"small"},{default:t(()=>[n(a(i.value.status),1)]),_:1},8,["type"])]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.cpu")},{default:t(()=>[n(a(i.value.cpu)+"%",1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.memory")},{default:t(()=>[n(a(i.value.memory)+"%",1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.command"),span:2},{default:t(()=>[d("pre",oe,a(i.value.command),1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.path"),span:2},{default:t(()=>[n(a(i.value.path||e.$t("processMonitor.detailsDialog.notAvailable")),1)]),_:1},8,["label"]),o(c,{label:e.$t("processMonitor.detailsDialog.started"),span:2},{default:t(()=>[n(a(i.value.started||e.$t("processMonitor.detailsDialog.notAvailable")),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])])}}},ae=j(te,[["__scopeId","data-v-d3f124e3"]]);export{ae as default};
