import{_ as $,r as p,o as Z,y as i,b as r,h as z,e as k,w as s,g as e,f as b,i as D,m as l,t as B,k as g,I as _,z as o}from"./index-JqcLm-KS.js";const M={class:"card-header"},U={class:"actions"},W={__name:"SambaStatus",setup(h){const n=p({installed:!1,active:!1,running:!1}),u=p(!1),m=p(!1),v=p(!1);Z(()=>{c()});function x(a){return a.installed?a.running?"success":"warning":"danger"}function C(a){return a.installed?a.error?"Błąd: "+a.error:a.running?"Działa":"Zatrzymana":"Nie zainstalowano"}async function c(){try{const a=await i.get("/services/samba/status");n.value={...a.data,error:null}}catch(a){n.value={installed:!1,active:!1,running:!1,error:a.response?.data?.error||"Błąd połączenia"},console.error("Status check error:",a)}}async function y(a){u.value=!0;try{await i.post("/services/samba/toggle",{action:a}),o.success(`Usługa Samba ${a==="start"?"włączona":"wyłączona"}`),await c()}catch{o.error(`Błąd podczas ${a==="start"?"włączania":"wyłączania"} usługi`)}finally{u.value=!1}}async function N(){m.value=!0;try{await i.post("/services/samba/toggle",{action:"stop"}),await i.post("/services/samba/toggle",{action:"start"}),o.success("Usługa Samba zrestartowana"),await c()}catch{o.error("Błąd podczas restartowania usługi")}finally{m.value=!1}}async function T(){v.value=!0;try{await i.post("/services/samba/install"),o.success("Instalacja Samby rozpoczęta"),await c()}catch{o.error("Błąd podczas instalacji Samby")}finally{v.value=!1}}return(a,t)=>{const d=r("el-icon"),w=r("el-tag"),f=r("el-button"),S=r("el-descriptions-item"),j=r("el-descriptions"),I=r("el-card");return k(),z(I,{class:"samba-status"},{header:s(()=>[b("div",M,[b("h2",null,[e(d,null,{default:s(()=>[e(g(_),{icon:"mdi:server-network"})]),_:1}),t[2]||(t[2]=l(" Status usługi Samba "))])])]),default:s(()=>[e(j,{column:1,border:""},{default:s(()=>[e(S,{label:"Zainstalowana"},{default:s(()=>[e(w,{type:n.value.installed?"success":"danger"},{default:s(()=>[l(B(n.value.installed?"Tak":"Nie"),1)]),_:1},8,["type"]),n.value.installed?D("",!0):(k(),z(f,{key:0,type:"primary",link:"",onClick:T,loading:v.value},{default:s(()=>t[3]||(t[3]=[l(" (Zainstaluj Sambę) ")])),_:1,__:[3]},8,["loading"]))]),_:1}),e(S,{label:"Status"},{default:s(()=>[e(w,{type:x(n.value)},{default:s(()=>[l(B(C(n.value)),1)]),_:1},8,["type"])]),_:1})]),_:1}),b("div",U,[e(f,{type:"primary",onClick:t[0]||(t[0]=V=>y("start")),disabled:n.value.running||!n.value.installed,loading:u.value},{default:s(()=>[e(d,null,{default:s(()=>[e(g(_),{icon:"mdi:play"})]),_:1}),t[4]||(t[4]=l(" Włącz "))]),_:1,__:[4]},8,["disabled","loading"]),e(f,{type:"danger",onClick:t[1]||(t[1]=V=>y("stop")),disabled:!n.value.running,loading:u.value},{default:s(()=>[e(d,null,{default:s(()=>[e(g(_),{icon:"mdi:stop"})]),_:1}),t[5]||(t[5]=l(" Wyłącz "))]),_:1,__:[5]},8,["disabled","loading"]),e(f,{onClick:N,disabled:!n.value.running,loading:m.value},{default:s(()=>[e(d,null,{default:s(()=>[e(g(_),{icon:"mdi:refresh"})]),_:1}),t[6]||(t[6]=l(" Restartuj "))]),_:1,__:[6]},8,["disabled","loading"])])]),_:1})}}},R=$(W,[["__scopeId","data-v-5bdecf6b"]]);export{R as default};
