import{a7 as _}from"./index-JqcLm-KS.js";var s={exports:{}},v=s.exports,h;function m(){return h||(h=1,function(u,P){(function(r,n){u.exports=n()})(v,function(){var r=function(){this._listeners={}};r.prototype.addEventListener=function(t,e){this._listeners[t]=this._listeners[t]||[],this._listeners[t].indexOf(e)<0&&this._listeners[t].push(e)},r.prototype.removeEventListener=function(t,e){if(this._listeners[t]){var o=this._listeners[t].indexOf(e);o>=0&&this._listeners[t].splice(o,1)}},r.prototype.dispatchEvent=function(t){if(this._listeners[t.type]&&this._listeners[t.type].length)for(var e=this._listeners[t.type].slice(),o=0,c=e.length;o<c;++o)e[o].call(this,t)};var n=function(t){return typeof t.constructor=="function"&&t.constructor.name==="GeneratorFunction"},p=function(t){return{next:function(){var e=t();return e?{value:e}:{done:!0}}}},l=function(t){var e=!1;return{next:function(){return e?{done:!0}:(e=!0,{value:t})}}},a=function(t,e){var o=typeof t;if(o==="object"){if(typeof t.next=="function")return t;if(typeof t.then=="function")return l(t)}return o==="function"?n(t)?t():p(t):l(e.resolve(t))},f=function(t,e,o){this.target=t,this.type=e,this.data=o},i=function(t,e,o){if(r.call(this),typeof e!="number"||Math.floor(e)!==e||e<1)throw new Error("Invalid concurrency");this._concurrency=e,this._options=o||{},this._options.promise=this._options.promise||Promise,this._iterator=a(t,this._options.promise),this._done=!1,this._size=0,this._promise=null,this._callbacks=null};return i.prototype=new r,i.prototype.constructor=i,i.prototype.concurrency=function(t){return typeof t<"u"&&(this._concurrency=t,this.active()&&this._proceed()),this._concurrency},i.prototype.size=function(){return this._size},i.prototype.active=function(){return!!this._promise},i.prototype.promise=function(){return this._promise},i.prototype.start=function(){var t=this,e=this._options.promise;return this._promise=new e(function(o,c){t._callbacks={reject:c,resolve:o},t._proceed()}),this._promise},i.prototype._fireEvent=function(t,e){this.dispatchEvent(new f(this,t,e))},i.prototype._settle=function(t){t?this._callbacks.reject(t):this._callbacks.resolve(),this._promise=null,this._callbacks=null},i.prototype._onPooledPromiseFulfilled=function(t,e){this._size--,this.active()&&(this._fireEvent("fulfilled",{promise:t,result:e}),this._proceed())},i.prototype._onPooledPromiseRejected=function(t,e){this._size--,this.active()&&(this._fireEvent("rejected",{promise:t,error:e}),this._settle(e||new Error("Unknown error")))},i.prototype._trackPromise=function(t){var e=this;t.then(function(o){e._onPooledPromiseFulfilled(t,o)},function(o){e._onPooledPromiseRejected(t,o)}).catch(function(o){e._settle(new Error("Promise processing failed: "+o))})},i.prototype._proceed=function(){if(!this._done){for(var t={done:!1};this._size<this._concurrency&&!(t=this._iterator.next()).done;)this._size++,this._trackPromise(t.value);this._done=t===null||!!t.done}this._done&&this._size===0&&this._settle()},i.PromisePoolEvent=f,i.PromisePool=i,i})}(s)),s.exports}var d=m();const E=_(d);export{E as P};
