import{_ as W,u as $,r as i,y as S,c as G,o as K,K as O,b as y,h as T,e as p,w as c,g as a,d as w,i as P,a4 as V,F as j,l as E,f as t,k as o,I as u,t as l,a5 as L,n as C}from"./index-JqcLm-KS.js";const q={class:"widget-header"},H={class:"header-left"},J={class:"header-actions"},Q={class:"disk-main"},X={class:"disk-info"},Y={class:"device"},Z={class:"mount"},ee={class:"size"},se={class:"disk-usage"},te={class:"percent"},ae={class:"progress-container"},ne={key:0,class:"error-message"},oe={name:"FileSystemWidget",displayName:"Dyski"},re=Object.assign(oe,{setup(ie){const{t:_}=$(),k=i([]),m=i(!1),h=i(null),d=i(!0),v=i(null),b=i("usage");S.defaults.baseURL=`${window.location.protocol}//${window.location.hostname}:3000`;const N=G(()=>[...k.value].sort((e,r)=>b.value==="name"?e.device.localeCompare(r.device):b.value==="size"?z(r.size)-z(e.size):r.percentNumber-e.percentNumber)),f=async()=>{m.value=!0,h.value=null;try{const e=await S.get("/api/filesystems");k.value=F(e.data)}catch(e){h.value="Błąd ładowania danych dyskowych",console.error(e)}finally{m.value=!1}},F=e=>(Array.isArray(e)?e:e.disks||Object.values(e)).map(s=>({device:s.device||"Unknown",size:s.size||"0B",percent:s.percent||"0%",percentNumber:I(s.percent),mount:s.mount||""})).filter(s=>!["tmpfs","devtmpfs"].includes(s.device)),I=e=>parseInt(e?.toString().replace("%",""))||0,z=e=>{const r={K:1,M:2,G:3,T:4},s=e?.match(/^(\d+\.?\d*)\s*([KMGTP]?)B?$/i);return s?parseFloat(s[1])*Math.pow(1024,r[s[2].toUpperCase()]||0):0},x=e=>e?e.replace(/(\d+\.?\d*)\s*([KMGTP]?)B?/i,"$1 $2B").trim():"0B",R=e=>e.device.startsWith("/dev/sd")?"mdi:harddisk":e.device.startsWith("/dev/dm")?"mdi:memory":e.device.startsWith("/dev/md")?"mdi:database":"mdi:harddisk",D=e=>({low:e<70,medium:e>=70&&e<90,high:e>=90}),A=()=>{d.value=!d.value,d.value?B():g()},B=()=>{g(),v.value=setInterval(f,3e4)},g=()=>{v.value&&(clearInterval(v.value),v.value=null)};return K(()=>{f(),B()}),O(()=>{g()}),(e,r)=>{const s=y("el-button"),M=y("el-tooltip"),U=y("el-card");return p(),T(U,{class:"widget-card",shadow:"hover"},{header:c(()=>[t("div",q,[t("div",H,[a(o(u),{icon:"mdi:harddisk",width:"18",height:"18",color:"#409EFF"}),t("h3",null,l(o(_)("fileSystem.title")),1)]),t("div",J,[a(M,{content:d.value?o(_)("fileSystem.autoRefreshOff"):o(_)("fileSystem.autoRefreshOn")},{default:c(()=>[a(s,{size:"small",onClick:A,text:""},{default:c(()=>[a(o(u),{icon:d.value?"mdi:pause-circle":"mdi:play-circle",width:"16",height:"16"},null,8,["icon"])]),_:1})]),_:1},8,["content"]),a(s,{size:"small",onClick:f,loading:m.value,text:""},{default:c(()=>[a(o(u),{icon:"mdi:refresh",width:"16",height:"16",class:C({spin:m.value})},null,8,["class"])]),_:1},8,["loading"])])])]),default:c(()=>[a(V,{name:"disk-list",tag:"div",class:"disk-container"},{default:c(()=>[(p(!0),w(j,null,E(N.value,n=>(p(),w("div",{key:n.device,class:"disk-item"},[t("div",Q,[a(o(u),{icon:R(n),width:"20",height:"20",class:"disk-icon"},null,8,["icon"]),t("div",X,[t("span",Y,l(n.device),1),t("span",Z,l(n.mount||"–"),1)]),t("span",ee,l(x(n.size)),1)]),t("div",se,[t("span",te,l(n.percentNumber)+"%",1),t("div",ae,[t("div",{class:C(["progress-bar",D(n.percentNumber)]),style:L({width:n.percentNumber+"%"})},null,6)])])]))),128))]),_:1}),h.value?(p(),w("div",ne,[a(o(u),{icon:"mdi:alert-circle",width:"16",height:"16",color:"#F56C6C"}),t("span",null,l(h.value),1)])):P("",!0)]),_:1})}}}),le=W(re,[["__scopeId","data-v-f3c68f73"]]);export{le as default};
