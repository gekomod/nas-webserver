import{y as c,_ as I,r as w,o as $,z as f,b as u,d as z,e as S,g as a,w as n,f as d,i as U,F as x,h as D,m as B,k as j,I as C}from"./index-JqcLm-KS.js";const p="/services/samba",b={async getShares(){try{return(await c.get(`${p}/shares`)).data}catch(o){throw console.error("Error fetching Samba shares:",o),o}},async createShare(o){try{return(await c.post(`${p}/shares`,o)).data}catch(l){throw console.error("Error creating Samba share:",l),l}},async updateShare(o,l){try{return(await c.put(`${p}/shares/${o}`,l)).data}catch(s){throw console.error("Error updating Samba share:",s),s}},async deleteShare(o){try{return(await c.delete(`${p}/shares/${o}`)).data}catch(l){throw console.error("Error deleting Samba share:",l),l}},async getSettings(){try{return(await c.get(`${p}/settings`)).data}catch(o){throw console.error("Error fetching Samba settings:",o),o}},async updateSettings(o){try{return(await c.put(`${p}/settings`,o)).data}catch(l){throw console.error("Error updating Samba settings:",l),l}},async restartService(){try{return(await c.post(`${p}/restart`)).data}catch(o){throw console.error("Error restarting Samba service:",o),o}},async getHomeDirSettings(){try{return(await c.get(`${p}/settings/homedirs`)).data}catch(o){throw console.error("Error getting home dir settings:",o),o}},async updateHomeDirSettings(o){try{const l={enabled:!!o.enabled,enableUserHomes:!!o.enableUserHomes,browsable:o.browsable!==!1,inheritAcls:o.inheritAcls!==!1,inheritPermissions:!!o.inheritPermissions,enableRecycleBin:o.enableRecycleBin!==!1,followSymlinks:!!o.followSymlinks,wideLinks:!!o.wideLinks};return(await c.post(`${p}/settings/homedirs`,l)).data}catch(l){throw console.error("Error updating home dir settings:",l),l}}},W={class:"samba-settings"},K={class:"action-buttons"},N={__name:"SambaSettings",setup(o){const l=w({workgroup:"WORKGROUP",security:"user",interfaces:"",bindInterfacesOnly:!1,logLevel:1}),s=w({enabled:!1,enableUserHomes:!1,browsable:!0,inheritAcls:!0,inheritPermissions:!1,enableRecycleBin:!0,followSymlinks:!1,wideLinks:!1}),y=w(!1),g=w(!1);$(()=>{L()});async function L(){try{const[i,e]=await Promise.all([b.getSettings(),b.getHomeDirSettings()]);l.value={workgroup:"WORKGROUP",security:"user",interfaces:"",bindInterfacesOnly:!1,logLevel:1,...i.data},s.value={enabled:!1,enableUserHomes:!1,browsable:!0,inheritAcls:!0,inheritPermissions:!1,enableRecycleBin:!0,followSymlinks:!1,wideLinks:!1,...e.data}}catch(i){f.error("Błąd ładowania ustawień: "+i.message)}}async function P(){try{y.value=!0;const i={settings:{workgroup:l.value.workgroup||"WORKGROUP",security:l.value.security||"user",interfaces:l.value.interfaces||"eth0",bindInterfacesOnly:l.value.bindInterfacesOnly!==!1,logLevel:l.value.logLevel||1}},e={enabled:s.value.enabled||!1,enableUserHomes:s.value.enableUserHomes||!1,browsable:s.value.browsable!==!1,inheritAcls:s.value.inheritAcls!==!1,inheritPermissions:s.value.inheritPermissions||!1,enableRecycleBin:s.value.enableRecycleBin!==!1,followSymlinks:s.value.followSymlinks||!1,wideLinks:s.value.wideLinks||!1};await Promise.all([b.updateSettings(i),b.updateHomeDirSettings(e)]),f.success("Ustawienia zapisane pomyślnie")}catch(i){console.error("Save settings error:",i),f.error("Błąd zapisywania ustawień: "+(i.response?.data?.error||i.message))}finally{y.value=!1}}async function R(){try{g.value=!0,await b.restartService(),f.success("Usługa zrestartowana pomyślnie")}catch(i){f.error("Błąd restartowania usługi: "+i.message)}finally{g.value=!1}}return(i,e)=>{const k=u("el-input"),r=u("el-form-item"),v=u("el-option"),A=u("el-select"),m=u("el-switch"),E=u("el-input-number"),_=u("el-form"),V=u("el-tab-pane"),H=u("el-tabs"),h=u("el-button"),O=u("el-card");return S(),z("div",W,[a(O,null,{header:n(()=>[d("h2",null,[a(j(C),{icon:"mdi:cog",width:"24",height:"24"}),e[13]||(e[13]=d("span",{style:{"margin-left":"10px"}},"Ustawienia Samba",-1))])]),default:n(()=>[a(H,{type:"border-card"},{default:n(()=>[a(V,{label:"Główne"},{default:n(()=>[a(_,{model:l.value,"label-width":"250px","label-position":"left"},{default:n(()=>[a(r,{label:"Workgroup"},{default:n(()=>[a(k,{modelValue:l.value.workgroup,"onUpdate:modelValue":e[0]||(e[0]=t=>l.value.workgroup=t)},null,8,["modelValue"])]),_:1}),a(r,{label:"Tryb bezpieczeństwa"},{default:n(()=>[a(A,{modelValue:l.value.security,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value.security=t)},{default:n(()=>[a(v,{label:"User",value:"user"}),a(v,{label:"Share",value:"share"}),a(v,{label:"Domain",value:"domain"})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"Interfejsy"},{default:n(()=>[a(k,{modelValue:l.value.interfaces,"onUpdate:modelValue":e[2]||(e[2]=t=>l.value.interfaces=t)},null,8,["modelValue"])]),_:1}),a(r,{label:"Bind tylko do interfejsów"},{default:n(()=>[a(m,{modelValue:l.value.bindInterfacesOnly,"onUpdate:modelValue":e[3]||(e[3]=t=>l.value.bindInterfacesOnly=t)},null,8,["modelValue"])]),_:1}),a(r,{label:"Poziom logowania"},{default:n(()=>[a(E,{modelValue:l.value.logLevel,"onUpdate:modelValue":e[4]||(e[4]=t=>l.value.logLevel=t),min:0,max:10},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),a(V,{label:"Katalogi domowe"},{default:n(()=>[a(_,{model:s.value,"label-width":"300px","label-position":"left"},{default:n(()=>[a(r,{label:"Włączone"},{default:n(()=>[a(m,{modelValue:s.value.enabled,"onUpdate:modelValue":e[5]||(e[5]=t=>s.value.enabled=t)},null,8,["modelValue"]),e[14]||(e[14]=d("div",{class:"form-hint"},"Aktywuje obsługę katalogów domowych",-1))]),_:1,__:[14]}),s.value.enabled?(S(),z(x,{key:0},[a(r,{label:"Włącz katalogi domowe użytkowników"},{default:n(()=>[a(m,{modelValue:s.value.enableUserHomes,"onUpdate:modelValue":e[6]||(e[6]=t=>s.value.enableUserHomes=t)},null,8,["modelValue"]),e[15]||(e[15]=d("div",{class:"form-hint"},"Udostępnia automatycznie katalogi domowe użytkowników",-1))]),_:1,__:[15]}),a(r,{label:"Do przeglądania"},{default:n(()=>[a(m,{modelValue:s.value.browsable,"onUpdate:modelValue":e[7]||(e[7]=t=>s.value.browsable=t)},null,8,["modelValue"]),e[16]||(e[16]=d("div",{class:"form-hint"},"Kontroluje widoczność udziału na liście dostępnych udziałów",-1))]),_:1,__:[16]}),a(r,{label:"Dziedzicz ACL-y"},{default:n(()=>[a(m,{modelValue:s.value.inheritAcls,"onUpdate:modelValue":e[8]||(e[8]=t=>s.value.inheritAcls=t)},null,8,["modelValue"]),e[17]||(e[17]=d("div",{class:"form-hint"},"Zapewnia honorowanie ACL-ów z katalogów nadrzędnych",-1))]),_:1,__:[17]}),a(r,{label:"Dziedzicz uprawnienia"},{default:n(()=>[a(m,{modelValue:s.value.inheritPermissions,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.inheritPermissions=t)},null,8,["modelValue"]),e[18]||(e[18]=d("div",{class:"form-hint"},"Nadpisuje domyślne maski uprawnień",-1))]),_:1,__:[18]}),a(r,{label:"Włącz kosz"},{default:n(()=>[a(m,{modelValue:s.value.enableRecycleBin,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.enableRecycleBin=t)},null,8,["modelValue"]),e[19]||(e[19]=d("div",{class:"form-hint"},"Tworzy kosz dla każdego użytkownika",-1))]),_:1,__:[19]}),a(r,{label:"Podążaj za dowiązaniami symbolicznymi"},{default:n(()=>[a(m,{modelValue:s.value.followSymlinks,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.followSymlinks=t)},null,8,["modelValue"]),e[20]||(e[20]=d("div",{class:"form-hint"},"Zezwala na obsługę dowiązań symbolicznych",-1))]),_:1,__:[20]}),s.value.followSymlinks?(S(),D(r,{key:0,label:"Szerokie linki"},{default:n(()=>[a(m,{modelValue:s.value.wideLinks,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.wideLinks=t)},null,8,["modelValue"]),e[21]||(e[21]=d("div",{class:"form-hint"},"Zezwala na dowiązania poza katalogiem domowym",-1))]),_:1,__:[21]})):U("",!0)],64)):U("",!0)]),_:1},8,["model"])]),_:1})]),_:1}),d("div",K,[a(h,{type:"primary",onClick:P,loading:y.value},{default:n(()=>e[22]||(e[22]=[B(" Zapisz ustawienia ")])),_:1,__:[22]},8,["loading"]),a(h,{onClick:R,loading:g.value},{default:n(()=>e[23]||(e[23]=[B(" Restartuj usługę ")])),_:1,__:[23]},8,["loading"])])]),_:1})])}}},G=I(N,[["__scopeId","data-v-26973d14"]]);export{G as default};
