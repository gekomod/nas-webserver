import{_ as U,r as u,c as f,o as V,K as j,b as v,v as A,h as E,e as n,w as r,d as l,x as F,g as s,m as h,k as x,I as N,F as M,l as W,f as y,t as w,y as k,z as d}from"./index-JqcLm-KS.js";const L={class:"widget-header"},O={key:0,class:"docker-offline"},R={key:1,class:"widget-content"},Z={key:0,class:"no-containers"},q={class:"container-name"},G={name:"DockerWidget",displayName:"Kontenery Docker"},H=Object.assign(G,{setup(J){const c=u([]),m=u(!1),i=u("unknown"),p=u(!1);let _=null;const D=f(()=>i.value==="active"),b=f(()=>i.value==="active"?"Docker działa":"Docker wyłączony"),I=f(()=>i.value==="active"?"success":"danger"),g=async()=>{try{const e=await k.get("/services/docker/status");i.value=e.data.status||"unknown",D.value?await C():c.value=[]}catch(e){console.error("Błąd pobierania statusu Dockera:",e),i.value="inactive"}},C=async()=>{try{m.value=!0;const e=await k.get("/services/docker/containers",{params:{all:!0}});let a=[];Array.isArray(e.data)?a=e.data:e.data.containers?a=e.data.containers:e.data.data&&(a=e.data.data),c.value=a.map(t=>({id:t.ID||t.containerID,names:t.Names||t.containerNames,state:t.State||t.status,loading:!1}))}catch(e){console.error("Błąd pobierania kontenerów:",e),d.error("Nie udało się pobrać listy kontenerów"),c.value=[]}finally{m.value=!1}},S=async()=>{try{p.value=!0,await k.post("/services/docker/start"),d.success("Docker został uruchomiony"),await g()}catch(e){console.error("Błąd uruchamiania Dockera:",e),d.error("Nie udało się uruchomić Dockera")}finally{p.value=!1}},$=async e=>{try{e.loading=!0;const a=e.state==="running"?"stop":"start";await k.post(`/services/docker/container/${e.id}/${a}`),d.success(`Kontener ${e.names} ${a==="stop"?"zatrzymany":"uruchomiony"}`),e.state=a==="stop"?"exited":"running"}catch(a){console.error("Błąd zmiany stanu kontenera:",a),d.error(`Nie udało się zmienić stanu kontenera ${e.names}`)}finally{e.loading=!1}};return V(()=>{g(),_=setInterval(g,15e3)}),j(()=>{_&&clearInterval(_)}),(e,a)=>{const t=v("el-tag"),z=v("el-button"),B=v("el-empty"),K=v("el-card"),T=A("loading");return n(),E(K,{class:"widget-card",shadow:"hover"},{header:r(()=>[y("div",L,[s(x(N),{icon:"mdi:docker",width:"20",class:"header-icon"}),a[0]||(a[0]=y("span",null,"Kontenery Docker",-1)),s(t,{type:I.value,size:"small",class:"status-tag"},{default:r(()=>[h(w(b.value),1)]),_:1},8,["type"])])]),default:r(()=>[D.value?F((n(),l("div",R,[c.value.length===0?(n(),l("div",Z,[s(B,{"image-size":100,description:"Brak uruchomionych kontenerów"})])):(n(!0),l(M,{key:1},W(c.value,o=>(n(),l("div",{key:o.id,class:"container-item"},[y("div",q,[y("span",null,w(o.names),1)]),s(z,{type:o.state==="running"?"success":"danger",size:"small",plain:"",onClick:P=>$(o),loading:o.loading},{default:r(()=>[h(w(o.state==="running"?"Uruchomiony":"Zatrzymany"),1)]),_:2},1032,["type","onClick","loading"])]))),128))])),[[T,m.value]]):(n(),l("div",O,[s(B,{description:"Docker jest wyłączony"},{default:r(()=>[s(z,{type:"primary",size:"small",onClick:S,loading:p.value},{default:r(()=>[s(x(N),{icon:"mdi:power",class:"button-icon"}),a[1]||(a[1]=h(" Uruchom Docker "))]),_:1,__:[1]},8,["loading"])]),_:1})]))]),_:1})}}}),X=U(H,[["__scopeId","data-v-c174393e"]]);export{X as default};
